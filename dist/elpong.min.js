!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("elpong",[],t):"object"==typeof exports?exports.elpong=t():e.elpong=t()}("undefined"!=typeof self?self:this,function(){return function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=16)}([function(e,t,n){"use strict";var r,o,i,s=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});if(Object.defineProperty(t,"__esModule",{value:!0}),void 0===a)var a=!0;a&&((o={0:"Scheme not found",1:"Collection not found",2:"Collection not found by singular name",3:"Collection with name already exists in scheme",4:"No scheme tags found",5:"No collection or element tags found",6:"No document",7:"Configuration has no selector",8:"Configuration has no name",9:"Element is new",10:"Element is not new",11:"Element has a selector value but is in new_elements array"})[2]="Element has no selector value but is in elements object",o[13]="Api url has not yet been set",o[14]="Field should be an array of selectors",o[15]="Element selector changed",o[16]="Snapshot not found",o[17]="Invalid snapshot identifier: must be number <= list.length, string or RegExp",o[18]="Pre element has an reference field that does not match the embedded element selector",o[19]="Selector is not matching get one request selector",o[20]="No selector value given in getOne action",o[21]="Content-Type header not set to application/json",o[22]="GET request can't have data. Use params",i=o);var c=function(r){function e(e,t){var n=i[e]?i[e]:"Error code "+e;return t?r.call(this,n+": "+t)||this:r.call(this,n)||this}return s(e,r),e}(Error);t.ElpongError=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.camelize=function(e){return e.replace(/_/g," ").replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")},t.removeFromArray=function(e,t){var n=e.indexOf(t);return-1!==n&&(e.splice(n,n+1),!0)},t.isInteger=function(e){return e===parseInt(e,10)},t.isNumber=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},t.isString=function(e){return"string"==typeof e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},t.endsWith=function(e,t){return e.endsWith?e.endsWith(t):e.substr(-t.length)===t},t.startsWith=function(e,t){return e.startsWith?e.startsWith(t):e.substr(0,t.length)===t},t.arrayFromHTML=function(e){return Array.from?Array.from(e):[].slice.call(e)},t.values=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&e.propertyIsEnumerable(n)&&t.push(e[n]);return t},t.includes=function(e,t){return-1<e.indexOf(t)},t.equalsJSON=function e(t,n){for(var r in t){var o=t[r],i=n[r];if("object"==typeof o){if(!e(o,i))return!1}else if(o!==i)return!1}return!0},t.copyJSON=function(e){return JSON.parse(JSON.stringify(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),r=n(17),o=n(18),c=n(11),l=n(12),i=n(19),s=n(22),u=n(1);function f(e){return!(!e&&0!==e&&""!==e||"string"!=typeof e&&"number"!=typeof e)}t.isSelectorValue=f;var p=function(){function e(e,t){this.fields={},this.relations={},this.actions={},this.snapshots={};var n=(this._collection=e).configuration();o.setup(this,n.fields,t),i.setup(this,n.relations),r.setup(this,n.actions),s.setup(this),this.snapshots.make("creation")}return e.prototype.collection=function(){return this._collection},e.prototype.selector=function(){return this.fields[this.collection().scheme().configuration().selector]},e.prototype.remove=function(){var e=this,t=this.selector();return void 0!==t?this.actions.delete().then(function(){e.collection().elements.delete(t)}):(u.removeFromArray(this.collection().newElements,this),{then:function(e){return e()},catch:function(){}})},e.prototype.save=function(){return this.isNew()?this.actions.post():this.actions.put()},e.prototype.isNew=function(){if(u.includes(this.collection().newElements,this)){if(this.selector())throw new a.ElpongError(11);return!0}if(this.selector())return!1;throw new a.ElpongError(12)},e.prototype.merge=function(o){var i=this,e=this.collection().configuration(),s=this.collection().scheme().configuration().selector;return u.forEach(e.fields,function(e,t){var n=o[t];if(n)if(e.embedded_element)l.handle(i,o,t,e);else if(e.embedded_collection)c.handle(i,o,t,e);else if(t===s){var r=i.fields[t];if(r!==n&&f(r)&&f(n))throw new a.ElpongError(15,r+" -> "+n);i.fields[t]=n}else i.fields[t]=n}),this},e}();t.Element=p},function(e,t,n){"use strict";function r(e){return e.scheme().configuration().collections[e.name]}Object.defineProperty(t,"__esModule",{value:!0}),t.getConfiguration=r,t.getSingularName=function(e){return r(e).singular},t.addElement=function(e,t){var n=t.selector();void 0!==n?e.elements.set(n,t):e.newElements.push(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,a=n(0),r=n(1);function o(e){if(r.isInteger(e)||!e)return e||0;var t=["angularjs","fetch","angular","jquery"].indexOf(e);return-1<t?t:0}t.executeRequest=function(e,t,n,r){r||(r={}),r.Accept=r["Content-Type"]="application/json";var o=JSON.stringify(void 0===n?{}:n),i={body:o,data:o,dataType:"json",headers:r,method:t,responseType:"json",type:t,url:e};return s(i.url,i)},t.setAjaxFunction=function(i,e){switch(o(e)){case 3:window.jQuery&&(s=function(e,t){var r=jQuery.Deferred(),n=i(e,t);return n.then(function(e,t,n){return r.resolve({data:e,status:n.statusCode().status,headers:n.getAllResponseHeaders()})}),n.catch(function(e,t,n){return r.reject({data:e,status:n.statusCode().status,headers:n.getAllResponseHeaders()})}),r.promise()});break;case 1:s=function(t,n){return new Promise(function(r,o){n.body="GET"===n.method?void 0:n.data;var e=i(t,n);e.then(function(t){if(204===t.status)r(t);else{var e=t.headers.get("content-type");if(!e||e.indexOf("json")<0)throw new a.ElpongError(21);var n=t.json();n.then(function(e){t.data=e,r(t)}),n.catch(o)}}),e.catch(o)})};break;case 2:s=function(e,n){return new Promise(function(r,t){n.responseType=void 0,i.request.bind(i)(e,n).subscribe(function(e){if(204===e.status)r(e);else{var t=e.headers.get("content-type");if(!t||t.indexOf("json")<0)throw new a.ElpongError(21);var n=e.json();e.data=n,r(e)}},function(e){t(e)})})};break;default:s=function(e,t){return i(t)}}},t.convertAjaxAdapterTypeStringToType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);function s(e,t){for(var n in e+="?",t)e=""+e+n+"="+encodeURIComponent(t[n])+"&";return e=e.slice(0,-1)}t.createForElement=function(e,t){var n,r=e.collection(),o=r.scheme().getApiUrl();if(!o)throw new i.ElpongError(13);return n=o+"/"+r.name,t.noSelector||(n=n+"/"+e.selector()),t.suffix&&(n=n+"/"+t.suffix),t.params&&(n=s(n,t.params)),n},t.createForCollection=function(e,t){var n=e.scheme().getApiUrl();if(!n)throw new i.ElpongError(13);var r=n+"/"+e.name;return t.suffix&&(r=r+"/"+t.suffix),t.params&&(r=s(r,t.params)),r},t.trimSlashes=function(e){return e.replace(/^\/|\/$/g,"")},t.isFqdn=function(e){return/^https?:\/\//.test(e)},t.appendParamsToUrl=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(3);t.getCollectionBySingularName=function(e,t){for(var n in e.getCollections()){var r=e.select(n);if(i.getSingularName(r)===t)return r}throw new o.ElpongError(2,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(0),o=n(8),s=n(1),a={},c=!1,l={add:function(e){var t=new o.Scheme(e);return a[t.name]=t},enableAutoload:function(){c=!0,l.load(!0)},get:function(e){var t=a[e];if(t)return t;throw new i.ElpongError(0,e)},isAutoloadEnabled:function(){return c},load:function(e){if("undefined"!=typeof document){var t=document.querySelectorAll("meta[name=elpong-scheme]");if(!e&&!t.length)throw new i.ElpongError(4);for(var n=0,r=s.arrayFromHTML(t);n<r.length;n++){var o=r[n];l.add(JSON.parse(o.content))}}},setAjax:function(e,t){r.setAjaxFunction(e,t)},tearDown:function(){c=!1,a={}}};t.elpong=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),i=n(15),s=n(7),r=n(0),a=n(5),c=function(){function e(e){var t=new i.SchemeConfiguration(e);for(var n in this._configuration=t,this.name=t.name,this._collections={},t.collections){t.collections[n];var r=new o.Collection(this,n);this._collections[n]=r}if(s.elpong.isAutoloadEnabled())for(var n in t.collections)this._collections[n].load(!0)}return e.prototype.configuration=function(){return this._configuration},e.prototype.select=function(e){var t=this._collections[e];if(t)return t;throw new r.ElpongError(1,e)},e.prototype.setApiUrl=function(e){var t=a.trimSlashes(e);return this.apiUrl=a.isFqdn(t)?t:"/"+t},e.prototype.getApiUrl=function(){return this.apiUrl},e.prototype.getCollections=function(){return this._collections},e}();t.Scheme=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),u=n(0),s=n(23),a=n(24),c=n(3),f=n(1),o=function(){function e(e,t){var r=this;this._scheme=e,this.name=t,this.elements=new s.FakeMap,this.newElements=[],this._defaultPreElement={};var n=c.getConfiguration(this);for(var o in n.fields){var i=n.fields[o];i.default&&(this._defaultPreElement[o]=i.default)}this.actions={getAll:function(e){return a.executeGetAll(r,e)},getOne:function(e,t){if(void 0===e)throw new u.ElpongError(20);return a.executeGetOne(r,e,t)}},f.forEach(n.collection_actions,function(t,n){r.actions[f.camelize(n)]=function(e){return void 0===e&&(e={}),a.executeCustom(r,n,t,e)}})}return e.prototype.scheme=function(){return this._scheme},e.prototype.load=function(e){var t=this;if("undefined"==typeof document)throw new u.ElpongError(6);var n=document.querySelectorAll("meta[name=elpong-collection][collection='"+this.name+"'][scheme='"+this.scheme().name+"']"),r=document.querySelectorAll("meta[name=elpong-element][collection='"+this.name+"'][scheme='"+this.scheme().name+"']");if(!e&&!n.length&&!r.length)throw new u.ElpongError(5);for(var o=0,i=f.arrayFromHTML(n);o<i.length;o++)for(var s=i[o],a=0,c=JSON.parse(s.content);a<c.length;a++){var l=c[a];this.buildOrMerge(l)}f.arrayFromHTML(r).map(function(e){return t.buildOrMerge(JSON.parse(e.content))})},e.prototype.configuration=function(){return c.getConfiguration(this)},e.prototype.array=function(e){return e||(e={noNew:!1}),(e.noNew?[]:this.newElements).concat(this.elements.values())},e.prototype.find=function(e){return this.elements.get(e)||null},e.prototype.findBy=function(e,t){var n;t||(t={});for(var r=[],o=0,i=this.array(t);o<i.length;o++){var s=i[o];for(var a in n=!0,e){var c=e[a];if(s.fields[a]!==c){n=!1;break}}if(n){if(!t.multiple)return s;r.push(s)}}return t.multiple?r:null},e.prototype.build=function(e){e||(e=this._defaultPreElement);var t=new r.Element(this,e);return c.addElement(this,t),t},e.prototype.buildOrMerge=function(e){var t=e[this.scheme().configuration().selector];if(t){var n=this.find(t);return n?n.merge(e):this.build(e)}return this.build(e)},e}();t.Collection=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n(1);t.toData=function(e,t){var n=e.collection(),r={},o=n.scheme().configuration().collections[n.name].fields;for(var i in o){var s=o[i];if(!(s.no_send||s.embedded_collection||s.embedded_element)){var a=e.fields[i];r[i]=t&&"object"==typeof a?c.copyJSON(a):a}}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),a=n(1),c=n(3);t.handle=function(e,t,n,r){var o=t[n];if(o){var i=e.collection().scheme().select(r.collection||n);a.forEach(o,function(e){var t=new s.Element(i,e);c.addElement(i,t)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=n(0),h=n(6);t.handle=function(e,t,n,r){var o=t[n];if(o){var i=e.collection(),s=i.scheme(),a=(r.collection?s.select(r.collection):h.getCollectionBySingularName(s,n)).buildOrMerge(o),c=r.reference_field||n+"_"+s.configuration().selector,l=i.configuration().fields[c];if(l&&l.reference){var u=a.selector(),f=t[c];if(void 0!==f&&f!==u)throw new p.ElpongError(18,f+" != "+u);e.fields[c]=u}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),l=n(1),u=n(3);function s(e,t,n,r,o){var i,s=u.getSingularName(t),a=(r.configuration(),t.scheme().configuration().selector);if(n.polymorphic){i=n.as+"_"+a;var c=n.as+"_collection";return function(){return function(e,t,n,r,o){for(var i=[],s=e.selector(),a=e.collection().name,c=0,l=t.array();c<l.length;c++){var u=l[c];if(s===u.fields[n]&&a===u.fields[r]&&(i.push(u),o))return i}return i}(e,r,i,c,o)}}return i=n.field?n.field:n.as?n.as+"_"+a:s+"_"+a,function(){return function(e,t,n,r){for(var o=[],i=e.selector(),s=0,a=t.array();s<a.length;s++){var c=a[s];if(i===c.fields[n]&&(o.push(c),r))return o}return o}(e,r,i,o)}}t.setup=function(e,t,n){var r=e.collection(),o=(r.configuration(),r.scheme().select(n.collection||t));if(n.inline){var i=n.inline_field||t+"_"+r.scheme().configuration().selector+"s";return e.relations[l.camelize(t)]=function(){return function(e,t,n){var r=e.fields[n];if(!Array.isArray(r))throw new c.ElpongError(14,n);for(var o=[],i=0,s=t.array();i<s.length;i++){var a=s[i];l.includes(r,a.selector())&&o.push(a)}return o}(e,o,i)}}return e.relations[l.camelize(t)]=s(e,r,n,o)},t.getHasManyRelationFunction=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=function(){function e(e,t){this.element=e,this.tag=t,this.data=r.toData(e,!0),this.undone=!1,this.time=Date.now(),this.index=e.snapshots.list.length,e.snapshots.list.push(this),e.snapshots.currentIndex=this.index}return e.prototype.revert=function(){var e=this.element.snapshots.list;this.element.merge(this.data),this.element.snapshots.currentIndex=this.index,this.undone=!1;for(var t=this.index+1,n=e.length;t<n;t++)e[t].undone=!0},e}();t.Snapshot=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=n(0),r=function(e){if(this.name=e.name,!this.name)throw new f.ElpongError(8);if(this.selector=e.selector,!this.selector)throw new f.ElpongError(7,e.name);for(var t in this.collections={},e.collections){for(var n=e.collections[t],r=this.collections[t]={singular:n.singular||t.slice(0,-1)},o=0,i=["fields","relations","actions","collection_actions"];o<i.length;o++){var s=i[o];r[s]=n[s]||{}}var a=n.relations;if(a)for(var c=0,l=["has_many","has_one","belongs_to"];c<l.length;c++){var u=l[c];a[u]=n.relations[u]||{}}}};t.SchemeConfiguration=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.default=r.elpong;var o=n(8);t.Scheme=o.Scheme;var i=n(9);t.Collection=i.Collection;var s=n(2);t.Element=s.Element;var a=n(0);t.ElpongError=a.ElpongError;var c=n(14);t.Snapshot=c.Snapshot;var l=n(15);t.SchemeConfiguration=l.SchemeConfiguration},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n(4),l=n(0),u=n(1),f=n(10),p=n(5);function i(n,r,e){var t;if(void 0===e&&(e={}),n.snapshots.make("before_"+r.toLowerCase()),e.data){if("GET"===r)throw new l.ElpongError(22);t=e.data}else"GET"!==r&&(t=f.toData(n));if("POST"===r){if(!n.isNew())throw new l.ElpongError(10)}else if(n.isNew())throw new l.ElpongError(9);var o={noSelector:"POST"===r,params:e.params||{}},i=c.executeRequest(p.createForElement(n,o),r,t,e.headers);return i.then(function(e){e.data&&n.merge(e.data),n.snapshots.make("after_"+r.toLowerCase());var t=n.collection();u.includes(t.newElements,n)&&(u.removeFromArray(t.newElements,n),t.elements.set(n.selector(),n))}),i}function s(r,e,o,t){void 0===t&&(t={});var n,i=o.method.toUpperCase();if(r.snapshots.make("before_"+e),t.data){if("GET"===i)throw new l.ElpongError(22);n=t.data}else o.no_data||(n=f.toData(r));var s={params:t.params||{},suffix:o.path||e};s.noSelector=o.no_selector;var a=c.executeRequest(p.createForElement(r,s),i,n,t.headers);return a.then(function(e){o.returns_other||(e.data&&r.merge(e.data),r.snapshots.make("after_"+i.toLowerCase()));var t=r.collection(),n=r.selector();n&&u.includes(t.newElements,r)&&(u.removeFromArray(t.newElements,r),t.elements.set(n,r))}),a}t.setup=function(r,e){for(var t=function(t){r.actions[t]=function(e){return i(r,t.toUpperCase(),e)}},n=0,o=["get","post","put","delete"];n<o.length;n++)t(o[n]);u.forEach(e,function(t,n){r.actions[u.camelize(n)]=function(e){if(r.isNew()&&!t.no_selector)throw new l.ElpongError(9);return s(r,n,t,e)}})},t.execute=i,t.executeCustom=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(11),a=n(12);t.setup=function(r,e,o){i.forEach(e,function(e,t){if(e.embedded_element)a.handle(r,o,t,e);else if(e.embedded_collection)s.handle(r,o,t,e);else{if(!o.hasOwnProperty(t))return;var n=o[t];r.fields[t]=n}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(20),i=n(13),s=n(21);t.setup=function(n,e){r.forEach(e.has_many,function(e,t){i.setup(n,t,e)}),r.forEach(e.has_one,function(e,t){s.setup(n,t,e)}),r.forEach(e.belongs_to,function(e,t){o.setup(n,t,e)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),c=n(1),l=n(6);t.setup=function(e,t,n){var r,o,i=e.collection();if(n.polymorphic){var s=n.collection_field||t+"_collection";r=n.field,e.relations[c.camelize(t)]=function(){return f(e,r,s,t)}}else{var a=i.scheme();o=n.collection?i.scheme().select(n.collection):l.getCollectionBySingularName(a,t),r=n.field||t+"_"+a.configuration().selector,e.relations[c.camelize(t)]=function(){return u(e,o,r)}}};var u=function(e,t,n){var r=e.fields[n];return o.isSelectorValue(r)?t.find(r)||null:void 0},f=function(e,t,n,r){var o=e.fields[n],i=e.collection().scheme().select(o);t||(t=r+"_"+e.collection().scheme().configuration().selector);var s=e.fields[t];return i.find(s)||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=n(6),c=n(13);t.setup=function(e,t,n){var r,o=e.collection(),i=(e.collection().configuration(),o.scheme());return r=n.collection?i.select(n.collection):a.getCollectionBySingularName(i,t),e.relations[s.camelize(t)]=function(){return c.getHasManyRelationFunction(e,o,n,r,!0)()[0]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(14),a=n(1);t.setup=function(o){var r=o.snapshots;r.list=[],r.make=function(e){return new s.Snapshot(o,e)},r.lastPersisted=function(){if(!o.isNew())for(var e=r.list.length-1;0<=e;e--){var t=r.list[e];if(a.includes(["after_post","after_put","after_get","creation"],t.tag))return t}},r.lastWithTag=function(e){var t=o.snapshots.list;if(a.isRegExp(e)){for(var n=t.length-1;0<=n;n--)if((r=t[n]).tag&&e.test(r.tag))return r}else for(n=t.length-1;0<=n;n--){var r;if(e===(r=t[n]).tag)return r}},r.last=function(){var e=o.snapshots.list;return e[e.length-1]},r.undo=function(e){if(null==e&&(e=0),a.isInteger(e)){var t=o.snapshots.list;if(e<0||e>t.length)throw new i.ElpongError(17,""+e);(n=t[o.snapshots.currentIndex-e]).revert()}else{var n;if(!(n=r.lastWithTag(e)))throw new i.ElpongError(16,""+e);n.revert()}return o},r.isPersisted=function(){var e=r.lastPersisted();return!!e&&a.equalsJSON(o.fields,e.data)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="undefined"!=typeof Map&&(new Map).values,i=function(){function e(){this.hasRealMap=o,this.map=o?new Map:{}}return e.prototype.get=function(e){return o?this.map.get(e):this.map[e]},e.prototype.set=function(e,t){return o?this.map.set(e,t):this.map[e]=t,this},e.prototype.has=function(e){return o?this.map.has(e):!!this.map[e]},e.prototype.values=function(){return o?Array.from(this.map.values()):r.values(this.map)},e.prototype.delete=function(e){o?this.map.delete(e):delete this.map[e]},e}();t.FakeMap=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),i=n(0),a=n(5);t.executeGetAll=function(t,e){if(void 0===e&&(e={}),e||(e={}),e.data)throw new i.ElpongError(22);var n=s.executeRequest(a.createForCollection(t,{params:e.params||{}}),"GET",void 0,e.headers);return n.then(function(e){e.data.map(function(e){t.buildOrMerge(e)})}),n},t.executeGetOne=function(n,r,e){if(void 0===e&&(e={}),e.data)throw new i.ElpongError(22);var t={params:e.params||{},suffix:r},o=s.executeRequest(a.createForCollection(n,t),"GET",void 0,e.headers);return o.then(function(e){if(e.data){var t=n.scheme().configuration().selector;if(e.data[t]!==r)throw new i.ElpongError(19,e.data[t]+" != "+r);n.buildOrMerge(e.data)}}),o},t.executeCustom=function(e,t,n,r){r||(r={});var o=r.data,i=n.method.toUpperCase();return s.executeRequest(a.createForCollection(e,{suffix:n.path||t,params:r.params}),i,o,r.headers)}}])});